/*********************************************************************************************/
本文档使用 TAB = 4 对齐，使用keil5默认配置打开阅读比较方便。

【*】程序简介

-工程名称：LCD显示JPG文件
-实验平台: 野火STM32 指南者 开发板 
-MDK版本：5.16
-ST固件库版本：3.5

【 ！】功能简介：
驱动3.2_2.8寸液晶屏，显示JPG文件

【 ！】实验操作：
连接好配套的3.2_2.8寸液晶屏，给实验板插入带实验文件的SD卡，下载程序后复位开发板即可，

【*】注意事项：
本工程编译后 jpg解码库有一些warning，不影响使用。

本程序显示的是SD卡内的图片，
实验前需要把本工程目录下的“需放SD卡文件”文件夹的内容拷贝到SD卡的根目录。

移植本工程到其它项目时，请注意启动文件的堆栈大小

2.8寸 屏幕芯片：ILI9341
3.2寸 屏幕芯片：ST7789V（现在生产使用）
开发板配套程序里已做兼容ILI9341和ST7789V（例程中的 LCD 函数仍以 ILI9341 为前缀命名）
高型号 STM32（如 STM32VET6/STM32ZET6 等）具有 FSMC 外设，直接使用 FSMC 接口实现 8080 时序
定义一个指向这些地址的指针，然后就可以通过指针直接修改该存储单元的内容，
FSMC 外设会自动完成数据访问过程，读写命令之类的操作不需要程序控制。

【*】显示自己的图片：
需要将jpg文件格式的图片拷贝到SD卡的根目录，图片的分辨率不能超过对应屏幕的分辨率
然后在主函数调用函数 jpgDisplay 来显示该图片。
比如jpgDisplay("0:/one_piece.jpg")
JPEG 和 JPG 是同一种图像压缩格式的不同表示方式，没有实质性的区别。

白屏条纹问题：
若是发现显示白屏的时候屏幕有明显条纹，可更改液晶屏内部的 Power control A (CBh) 寄存器的第5个参数，
将该参数的值改到最大0x06，就不会有白屏条纹了。程序里已默认改为最大0x06。

/***************************************************************************************************************/

【*】 引脚分配

液晶屏：
液晶屏接口与STM32的FSMC接口相连，支持565格式，
使用FSMC产生8080时序与液晶屏驱动芯片ILI9341通讯.

		/*液晶控制信号线*/
		ILI9341_CS 	<--->	PD7      	//片选，选择NOR/SRAM块 BANK1_NOR/SRAM1
		ILI9341_DC  <---> 	PD11		//PD11为FSMC_A16,本引脚决定了访问LCD时使用的地址
		ILI9341_WR 	<---> 	PD5			//写使能
		ILI9341_RD  <---> 	PD4			//读使能
		ILI9341_RST	<---> 	PE1			//复位引脚
		ILI9341_BK 	<---> 	PD12 		//背光引脚
		
	数据信号线省略,本实验没有驱动触摸屏，详看触摸画板实验。

SDIO(microSD卡座，支持32G以内的SD卡)：
microtSD卡座的SDIO接口与STM32的SDIO相连。
		SDIO_D0	<--->PC8
		SDIO_D1	<--->PC9
		SDIO_D2	<--->PC10
		SDIO_D3	<--->PC11
		SDIO_CK	<--->PC12
		SDIO_CMD<--->PD2
        	
LED：
	LED_R<-----> PB5
	LED_G<-----> PB0
	LED_B<-----> PB1  对应引脚低电平则LED灯亮
    
串口(TTL-USB TO USART)：
CH340的收发引脚与STM32的发收引脚相连。
	CH340  RXD  <----->  USART1  TX  (PA9)
	CH340  TXD  <----->  USART1  RX  (PA10)

【&】程序描述：

	  <jpgPort.c>
      
        void jpgDisplay(char *pic_name)这个函数使用了 TJpgDec 库进行 JPEG 解压缩和显示。	
        定义变量和对象：
        void *work：解码器的工作区指针，用于存储解码过程中的临时数据。
        JDEC jdec：JPEG 解压缩对象，用于管理解压缩过程。
        JRESULT res：TJpgDec API 的结果代码。
        IODEV devid：用户定义的设备标识符，用于传递给 JPEG 文件访问函数。
        FIL jpgFile：用于打开 JPEG 文件的文件对象。
        FRESULT fres：文件操作的结果代码。
        
        打开 JPEG 文件：
        使用 FatFs 文件系统的 f_open 函数打开指定的 JPEG 文件，并通过 fres 变量记录操作结果。
        如果成功打开文件，则将文件对象的指针 &jpgFile 分配给 devid.fp。
        
        分配解码空间：
        使用 malloc 函数为 TJpgDec 解码器分配工作区，大小为 sizeof(char) * 7 * 1024 字节。这个工作区将用于解码过程中的临时存储。
        
        准备解压缩：
        使用 jd_prepare 函数对 TJpgDec 进行准备，传入解码器对象 jdec、输入函数 in_func、工作区指针 work、工作区大小 7*1024 和设备标识符 devid。
        如果准备成功，将可以获得图像的信息，如图像的宽度、高度和实际使用的字节数等。
        
        解压缩和显示：
        使用 jd_decomp 函数开始解压缩过程，并传入解码器对象 jdec、输出函数 out_func 和参数 0。
        如果解压缩成功，将会显示 "OK" 消息。
        如果解压缩失败，将会显示失败的原因和返回的结果代码。
        
        释放资源：
        使用 free 函数释放之前分配的解码器工作区 work 的内存。
        使用 f_close 函数关闭 JPEG 文件。
      
/*********************************************************************************************/

【*】 版本

-程序版本：1.0
-发布日期：2013-10

/*********************************************************************************************/

【*】 联系我们

-野火官网  :https://embedfire.com
-野火论坛  :http://www.firebbs.cn
-野火商城  :https://yehuosm.tmall.com/
-野火资料下载中心 :http://doc.embedfire.com/products/link

/*********************************************************************************************/